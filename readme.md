
This is an extension of Jeffrey Way's gist: https://gist.github.com/JeffreyWay/b501c53d958b07b8a332

All credit should go to him for doing the heavy lifting. If there are any errors, the blame should go to me.

